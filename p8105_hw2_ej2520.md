Homework 2: Data Wrangling
================

## Problem 1

This is the start of Homework 2 for P8105: Data Science 1. First, we are
going to attach the packages needed for this homework.

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(readxl)
```

Next, we are going to import and clean the NYC Transit Subway dataset.

``` r
transit_df = 
  read_csv(file = "NYC_Transit_Subway_Entrance_And_Exit_Data.csv",
  col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11 = "c")) |>
janitor::clean_names() |>
  select(
    line, station_name, station_latitude, station_longitude, starts_with("route"),
    entry, exit_only, vending, entrance_type, ada) |>
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))
```

How many distinct stations are there?

``` r
transit_df |> 
  select(station_name, line) |>
  distinct()
```

    ## # A tibble: 465 × 2
    ##    station_name             line    
    ##    <chr>                    <chr>   
    ##  1 25th St                  4 Avenue
    ##  2 36th St                  4 Avenue
    ##  3 45th St                  4 Avenue
    ##  4 53rd St                  4 Avenue
    ##  5 59th St                  4 Avenue
    ##  6 77th St                  4 Avenue
    ##  7 86th St                  4 Avenue
    ##  8 95th St                  4 Avenue
    ##  9 9th St                   4 Avenue
    ## 10 Atlantic Av-Barclays Ctr 4 Avenue
    ## # ℹ 455 more rows

How many stations are ADA complaint? 84 stations.

``` r
transit_df |> 
  filter(ada == "TRUE") |>
  select(station_name, line) |> 
  distinct()
```

    ## # A tibble: 84 × 2
    ##    station_name                   line           
    ##    <chr>                          <chr>          
    ##  1 Atlantic Av-Barclays Ctr       4 Avenue       
    ##  2 DeKalb Av                      4 Avenue       
    ##  3 Pacific St                     4 Avenue       
    ##  4 Grand Central                  42nd St Shuttle
    ##  5 34th St                        6 Avenue       
    ##  6 47-50th Sts Rockefeller Center 6 Avenue       
    ##  7 Church Av                      6 Avenue       
    ##  8 21st St                        63rd Street    
    ##  9 Lexington Av                   63rd Street    
    ## 10 Roosevelt Island               63rd Street    
    ## # ℹ 74 more rows

What proportion of station entrances/exits without vending allow
entrance?

``` r
transit_df |> 
  filter(vending == "NO") |>
  pull(entry) |>
  mean()
```

    ## [1] 0.3770492

How many distinct stations serve the A train? Of the stations that serve
the A train, how many are ADA complaint?

60 stations serve the A train. Of the stations that serve the A train,
none are ADA complaint.

``` r
transit_df |> 
  pivot_longer(
    route1:route11, 
    names_to = "route_num", 
    values_to = "route") |>
  filter(route == "A") |>
  select(station_name, line) |>
  distinct()
```

    ## # A tibble: 60 × 2
    ##    station_name                  line           
    ##    <chr>                         <chr>          
    ##  1 Times Square                  42nd St Shuttle
    ##  2 125th St                      8 Avenue       
    ##  3 145th St                      8 Avenue       
    ##  4 14th St                       8 Avenue       
    ##  5 168th St - Washington Heights 8 Avenue       
    ##  6 175th St                      8 Avenue       
    ##  7 181st St                      8 Avenue       
    ##  8 190th St                      8 Avenue       
    ##  9 34th St                       8 Avenue       
    ## 10 42nd St                       8 Avenue       
    ## # ℹ 50 more rows

``` r
transit_df |> 
  pivot_longer(
    route1:route11,
    names_to = "route") |>
  filter(route == "A", ada == TRUE) |>
  select(station_name, line) |>
  distinct()
```

    ## # A tibble: 0 × 2
    ## # ℹ 2 variables: station_name <chr>, line <chr>

## Problem 2

This is the start of Problem 2. First, we are going to import the
Mr. Trash Wheel dataset.We will clean the variable names, and convert
the sports_balls variable into an integer variable.

``` r
library(readxl)

trash_df = 
  read_excel("202409_Trash_Wheel_Collection_Data.xlsx",
    na = c("NA", "")) |> 
  janitor::clean_names() |> 
  mutate(sports_balls = as.integer(round(sports_balls))) |>
  mutate(year = as.numeric(year)) |>
  mutate(mr_trash_wheel = plastic_bottles + plastic_bags) 
```

    ## New names:
    ## • `` -> `...15`
    ## • `` -> `...16`

Next, we are importing the Professor Trash Wheel sheet from the Trash
Wheel dataset.

``` r
professor_df = 
  read_excel("202409_Trash_Wheel_Collection_Data.xlsx", sheet = "Professor Trash Wheel",
    na = c("NA", "")) |>
  janitor::clean_names() |>
  mutate(professor_wheel = plastic_bottles + plastic_bags)
```

Now, we are importing the Gwynnda Trash Wheel sheet from the Trash Wheel
dataset.

``` r
Gwynnda_df = 
  read_excel("202409_Trash_Wheel_Collection_Data.xlsx", sheet = "Gwynnda Trash Wheel",
    na = c("NA", "")) |>
  janitor::clean_names() |> 
mutate(Gwynnda_wheel = plastic_bottles + plastic_bags)
```

As the next step to this problem, we are going to combine the Mr. Trash
Wheel, Professor Trash Wheel, and the Gwynnda Trash Wheel datasets.

``` r
trash_tidy = 
  bind_rows(trash_df, professor_df, Gwynnda_df) |> 
  janitor:: clean_names() |> 
  pivot_longer(
    mr_trash_wheel:gwynnda_wheel,
    names_to = "Dataset_type", 
    values_to = "plastic")
```

Our combined data has 3,114 observations and 18 variables.Some key
variables are weight_tons, volume_cubic_yards, plastic_bottles,
polystyrene, cigarette_butts, and glass_bottles.

## Problem 3

First, I am going to import and clean the individual bakers dataset.

``` r
bakers_df = 
  read_csv("gbb_datasets/bakers.csv",
    na = c("NA", "", ".")) |>
  janitor::clean_names()
```

    ## Rows: 120 Columns: 5
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (3): Baker Name, Baker Occupation, Hometown
    ## dbl (2): Series, Baker Age
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Next, we are importing and cleaning the bakes dataset.

``` r
bakes_df = 
  read_csv("gbb_datasets/bakes.csv",
    na = c("NA", "", ".")) |>
  janitor::clean_names()
```

    ## Rows: 548 Columns: 5
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (3): Baker, Signature Bake, Show Stopper
    ## dbl (2): Series, Episode
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Finally, we are importing and cleaning the results dataset. For the
results dataset, I renamed the columns “series”, “episode”, “baker”,
“technical”, and “results.” Next, I am going to remove the first three
rows of the results dataset, and then change the series and episode
variables to numeric. Should I have changed the results variable to
something other than character?

``` r
results_df = 
  read_csv("gbb_datasets/results.csv", 
    na = c("NA", "", "."), col_names = c("series", "episode", "baker", "technical","result"), col_types = cols('series' = col_double(), 'episode' = col_double(), 'technical' = col_double())) |>
  janitor::clean_names() 
```

    ## Warning: One or more parsing issues, call `problems()` on your data frame for details,
    ## e.g.:
    ##   dat <- vroom(...)
    ##   problems(dat)

``` r
results_df <- results_df[-c(1,2,3),]
```

Merging the datasets.

``` r
bakers_mid <- bakers_df |>
  anti_join(bakes_df, by = "series")

bake_final <- bakers_mid |>
  anti_join(results_df, by = "series")
```

Exporting the datasets.

``` r
write_csv(bake_final, "bake_final.csv")
```
